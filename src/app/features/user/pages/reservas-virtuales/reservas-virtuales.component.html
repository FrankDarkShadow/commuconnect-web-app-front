<div class="container-padre">

  <!-- =========== HEADER =========== -->
  <div class="header">
    <!-- Izquierda: Flecha y badge de paso -->
    <div class="header-left">
      <button class="btn-back" (click)="retroceder()" [disabled]="step === 1">&#x2039;</button>
      <span class="badge-step">Paso {{ step }} de 3</span>
    </div>

    <!-- Centro: título y reservas -->
    <div class="titulo-con-reservas">
      <h2>Sesiones Disponibles</h2>
      <span *ngIf="topesEstado" class="reservas-disponibles">
        {{ topesEstado }}
      </span>
    </div>
  </div>

  <hr />

  <!-- PASO 1: Selección de Profesional -->
  <div *ngIf="step === 1" class="step-container">
    <div class="card">
      <label>Profesionales:</label>
      <div class="profesionales-container">
        <div
          class="profesional-item"
          *ngFor="let profesional of profesionales"
          [class.selected]="profesionalSeleccionado === profesional.id_profesional"
          (click)="seleccionarProfesional(profesional)"
        >
          {{ profesional.nombre_completo }}
        </div>
      </div>
    </div>

    <div class="footer-step">
      <button class="btn-continuar" [disabled]="!profesionalSeleccionado" (click)="continuar()">Continuar</button>
    </div>
  </div>

  <!-- PASO 2: Selección de Fecha -->
  <div *ngIf="step === 2" class="step-container">
    <div class="card-row">
      <div class="card"><label>Profesional elegido:</label><input [value]="nombreProfesional()" readonly /></div>
    </div>
    <div class="card">
      <label>Fecha de inicio</label>
      <div class="fechas-container">
        <div
          class="fecha-item"
          *ngFor="let fecha of fechasDisponibles"
          [class.selected]="fechaSeleccionada === fecha.dia"
          (click)="fechaSeleccionada = fecha.dia"
        >
          {{ fecha.dia }}
        </div>
      </div>
    </div>

    <div class="footer-step">
      <button class="btn-continuar" [disabled]="!fechaSeleccionada" (click)="continuar()">Continuar</button>
    </div>
  </div>

  <!-- PASO 3: Tabla de Sesiones -->
  <div *ngIf="step === 3" class="step-container sesiones-container">
    <div class="card-row">
      <div class="card"><label>Profesional elegido:</label><input [value]="nombreProfesional()" readonly /></div>
      <div class="card"><label>Fecha elegida:</label><input [value]="fechaSeleccionada" readonly /></div>
    </div>

    <div *ngIf="cargandoSesiones" class="text-muted">Cargando sesiones disponibles…</div>
    <div *ngIf="!cargandoSesiones && sinSesiones" class="text-danger">No hay sesiones disponibles.</div>

    <div *ngIf="!cargandoSesiones && !sinSesiones" class="tabla-wrapper">
      <table class="tabla-sesiones">
        <thead>
          <tr>
            <th>Fecha</th><th>Ubicación</th><th>Responsable</th><th>Hora Inicio</th>
            <th>Hora Fin</th><th>Vacantes totales</th><th>Vacantes libres</th><th>Seleccionar</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of sesionesDisponibles; let i = index">
            <td>{{ s.fecha }}</td><td>{{ s.ubicacion }}</td><td>{{ s.responsable }}</td>
            <td>{{ s.hora_inicio }}</td><td>{{ s.hora_fin }}</td>
            <td>{{ s.vacantes_totales }}</td><td>{{ s.vacantes_libres }}</td>
            <td>
              <input type="radio" name="radioSesion" [checked]="sesionSeleccionadaIndex === i" (change)="seleccionarSesion(i)" />
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="footer-step sesiones-footer">
      <button class="btn-reservar" [disabled]="sesionSeleccionadaIndex === null" (click)="reservar()">RESERVAR</button>
    </div>
  </div>
</div>
