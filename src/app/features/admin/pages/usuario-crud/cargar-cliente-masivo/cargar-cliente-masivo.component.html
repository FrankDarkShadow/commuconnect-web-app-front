<!-- Contenido -->
<main class="contenido">


 
    <div class="bloque-central">


        <div class="volver-container">
            <button class="btn-volver-servicios" [routerLink]="['/admin/lista-cliente']">
              ‚¨Ö  Volver 
            </button>
          </div>

        <main class="contenido">
            <div class="bloque-central container mt-5">
          
              <h2 class="mb-4">Carga clientes :</h2>
          
              <!-- Zona Drag & Drop -->
              <div class="border border-2 border-primary rounded p-5 text-center bg-light"
                   (drop)="onFileDrop($event)"
                   (dragover)="onDragOver($event)"
                   (dragleave)="onDragLeave($event)"
                   [class.bg-white]="isHovering"
                   style="transition: background-color 0.3s; cursor: pointer;"
                   (click)="fileInput.click()">
                   <i class="bi bi-upload fs-1 text-primary mb-3 d-block"></i>
                <p class="fs-5 text-muted">üìÇ Suelta aqu√≠ tu archivo Excel (.xlsx) o haz clic para seleccionarlo</p>
                <input type="file"
                       hidden
                       #fileInput
                       (change)="onFileSelected($event)"
                       accept=".xlsx" />
              </div>
          
              <!-- Barra persistente de archivo -->
              <div class="mt-3 d-flex align-items-center gap-3">
                <div class="alert alert-secondary mb-0 flex-grow-1 d-flex justify-content-between align-items-center">
                  <span>
                    <strong>üìÑ Archivo:</strong>
                    {{ archivoSeleccionado?.name || 'Sin archivo seleccionado' }}
                  </span>
                  <button *ngIf="archivoSeleccionado"
                          class="btn btn-sm btn-outline-danger"
                          (click)="eliminarArchivo()">
                    üóëÔ∏è Quitar
                  </button>
                </div>
              </div>
          
              <!-- Vista previa -->
              <div *ngIf="excelData.length > 0" class="mt-4">
                <h5>Vista previa:</h5>
                <table class="table table-bordered table-sm">
                  <thead>
                    <tr>
                      <th *ngFor="let header of excelHeaders">{{ header }}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let row of excelData.slice(0, 5)">
                      <td *ngFor="let header of excelHeaders">{{ row[header] }}</td>
                    </tr>
                  </tbody>
                </table>
          
                <button class="btn btn-success" (click)="subirArchivo()">Cargar usuarios</button>
              </div>
          
            </div>
          </main>
          
          
          

    </div>

</main>
